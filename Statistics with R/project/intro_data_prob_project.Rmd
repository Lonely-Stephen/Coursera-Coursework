---
title: "Exploring the BRFSS data"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
```

### Load data

```{r load-data}
load("brfss2013.RData")
```

* * *

## Part 1: Data
I conduct my research using the BRFSS dataset. According to the background, Since 2011, BRFSS conducts both landline telephone- and cellular telephone-based surveys and collects randomly selected adults. Since each interviewee in the population is equally likely to be selected, the resulting sample is likely representative of the population. Therefore the study's results are generalizable to the population at large.

However, the survey may suffer from some potential bias such as convenience sample, non-response and voluntary response.

Meanwhile, since it is a observational study which doesn't include random assignment, the data can't suggest causation.

* * *

## Part 2: Research questions

**Research quesion 1:**
**"Does sleep time related to one's general health?**
It is well believed that people with sufficient sleep time are more likely to keep health. The data censuses how much time an interviewee sleep as well as one's general health situation. Therefore, it is possible to visualize the relationship between them. Finally, we can separate person with different health situation and compare the average value of sleep time in diverse groups.

**Research quesion 2:**


**Research quesion 3:**


* * *

## Part 3: Exploratory data analysis

**Research quesion 1:**
```{r}
brfss2013 %>% select(genhlth, sleptim1) %>% na.omit() %>% filter(genhlth == "Poor") %>% group_by(sleptim1) %>% ggplot(aes(x=sleptim1)) + geom_histogram(binwidth = 0.5) + ggtitle('Hours of Sleep Time Per Day for Poor General Health People') + xlab('sleep time')
``` 
From the plot, we can find that there are many outliers in this data. The distribution is right skewed, which suggests that too much sleep may not healthy. People who announces their general health is poor are most likely to sleep 6 hours per day.

```{r}
brfss2013 %>% select(genhlth, sleptim1) %>% na.omit() %>% filter(genhlth == "Fair") %>% group_by(sleptim1) %>% ggplot(aes(x=sleptim1)) + geom_histogram(binwidth = 0.5) + ggtitle('Hours of Sleep Time Per Day for Fair General Health People') + xlab('sleep time')

```
From the plot, we can find that it is more symmetric than the plot above. There are less outliers in this dataset. People who announces their general health is fair are most likely to sleep 6~7 hours per day.

```{r}
brfss2013 %>% select(genhlth, sleptim1) %>% na.omit() %>% filter(genhlth == "Good") %>% group_by(sleptim1) %>% ggplot(aes(x=sleptim1)) + geom_histogram(binwidth = 0.5) + ggtitle('Hours of Sleep Time Per Day for Good General Health People') + xlab('sleep time')
```
The proportion of people who sleep 7 hours per day in this group is higher than before.

```{r}
brfss2013 %>% select(genhlth, sleptim1) %>% na.omit() %>% filter(genhlth == "Very good") %>% group_by(sleptim1) %>% ggplot(aes(x=sleptim1)) + geom_histogram(binwidth = 0.5) + ggtitle('Hours of Sleep Time Per Day for Very Good General Health People') + xlab('sleep time')
```
The proportion of people who sleep 7~8 hours per day in this group is higher than before, and there is almost no outlier.

```{r}
brfss2013 %>% select(genhlth, sleptim1) %>% na.omit() %>% filter(genhlth == "Excellent") %>% group_by(sleptim1) %>% ggplot(aes(x=sleptim1)) + geom_histogram(binwidth = 0.5) + ggtitle('Hours of Sleep Time Per Day for Excellent General Health People') + xlab('sleep time')
```
The distribution of sleep time of excellent general health people is similar to people with very good general health. The proportion of people who sleep 8 hours per day in this group is higher than before.

```{r}
data1 <- brfss2013 %>% select(genhlth, sleptim1) %>% na.omit() %>%  group_by(genhlth) %>% summarise(mean = mean(sleptim1), .groups = 'drop') 
data1
```
The mean value decrease progressively as the general health become poorer.

```{r}
ggplot(data=data1, aes(x=genhlth, y=mean)) + geom_bar(stat="identity")
```
Based on the mean value of each group and the distribution of each group, we can deduce that there is a correlation between people's general health and sleep time.

**Research quesion 2:**

```{r}
data2 <- brfss2013 %>% select(nummen, numwomen, genhlth) %>% na.omit() %>% mutate(prop = nummen/numwomen) 
data2
```

```{r}
ggplot(data2, aes(x=nummen, y=numwomen, colour=genhlth)) +
  geom_point(alpha=0.3) + facet_wrap( ~ genhlth, ncol=3) 
```



**Research quesion 3:**

```{r}

```

